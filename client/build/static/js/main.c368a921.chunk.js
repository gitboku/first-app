(window.webpackJsonpclient=window.webpackJsonpclient||[]).push([[0],{106:function(e,n,t){},121:function(e,n,t){},122:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),o=t(9),c=t.n(o),l=t(63),s=t(64),i=t(65),u=t(74),h=t(66),d=t(20),g=t(73),p=(t(88),t(67)),m=t.n(p).a.create({headers:{"Content-Type":"application/json"}}),k=function(){return new Promise((function(e,n){m.post("http://localhost:3001/graphql",{query:"query { genreGroups { id booksGenreId booksGenreName genres { booksGenreId booksGenreName }}}"}).then((function(n){e(n.data.data.genreGroups)})).catch((function(e){console.log(e),n([])}))}))},f=function(e){var n="",t=Object.keys(e);return 0===t.length?n:(t.forEach((function(t){n+="".concat(t,": ").concat(e[t],",")})),n.slice(0,-1))};function b(e){return console.log(e.books),0===(null==e.books?0:Object.keys(e.books).length)?r.a.createElement(E,null):r.a.createElement("div",{style:{whiteSpace:"pre-line"}},r.a.createElement("ul",null,this.props.books))}function E(e){return r.a.createElement("h1",null,"\u66f8\u7c4d\u304c\u3042\u308a\u307e\u305b\u3093\u3002")}var v=t(160),C=t(157),G=t(164),y=t(165),N=t(171),O=t(159),S=t(161),T=t(31),j=t(163),I=t(166),F=t(162),P=t(72),w=t.n(P);t(106);function x(e){var n=e.genreGroups;return r.a.createElement(C.a,{className:"GenreGroup",key:"genre-groups-list",subheader:r.a.createElement(O.a,{component:"div",id:"nested-list-subheader"},"\u30b8\u30e3\u30f3\u30eb")},n.map((function(n){var t=n.booksGenreId,a=n.isChecked;return r.a.createElement("div",{className:"genre-group-container"},r.a.createElement(B,{id:t,key:t,genreGroup:n},n.genres.map((function(n){var t=n.booksGenreId,a=n.isChecked;return r.a.createElement(z,{id:t,key:t,genre:n,checked:a,onClick:function(){return e.onClick(t,a)}})}))),r.a.createElement(N.a,{edge:"end",onChange:function(){return e.onClick(t,a)},checked:e.checked,className:"genre-group-checkbox",inputProps:{"aria-labelledby":t}}))})))}var q=Object(v.a)((function(e){return{root:{},heading:{fontSize:e.typography.pxToRem(15),flexShrink:0},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary},list:{backgroundColor:e.palette.background.paper}}}));function B(e){var n=q(),t=e.id;return r.a.createElement(S.a,{id:"genre-group-".concat(t),className:"genre-group-panel"},r.a.createElement(F.a,{expandIcon:r.a.createElement(w.a,null),"aria-controls":"panel1a-content",id:"panel1a-header-".concat(t)},r.a.createElement(T.a,{className:n.heading},function(e){var n=e.indexOf("\uff08"),t=e.lastIndexOf("\uff09");return-1===n||-1===t?e:e.substring(n+1,t)}(e.genreGroup.booksGenreName))),r.a.createElement(j.a,null,r.a.createElement(C.a,{className:n.list},e.children)))}function z(e){var n=e.id;return r.a.createElement(G.a,{key:n},r.a.createElement(y.a,{id:"genre".concat(n),primary:e.genre.booksGenreName}),r.a.createElement(I.a,null,r.a.createElement(N.a,{edge:"end",onChange:e.onClick,checked:e.checked,inputProps:{"aria-labelledby":n}})))}var A=t(169),J=t(170),Q=t(167),R=(t(120),t(168)),W=t(123);function D(e){return e.forEach((function(e){e.isChecked=!1,e.genres.forEach((function(e){e.isChecked=!1}))})),e}var H=function(e){function n(e){var t;return Object(s.a)(this,n),(t=Object(u.a)(this,Object(h.a)(n).call(this,e))).state={hasError:!1,books:[],title:"",pageFrom:"",pageTo:"",genreGroups:[],usedGenres:!1},k().then((function(e){t.setState({genreGroups:D(Object.values(e))})})).catch((function(e){console.log("error occured = "+e)})),t.handleChangeTitleField=t.handleChange.bind(Object(d.a)(t)),t.handleChangePageFromField=t.handleChange.bind(Object(d.a)(t)),t.handleChangePageToField=t.handleChange.bind(Object(d.a)(t)),t.handleChangeToggleGenre=t.handleChangeToggle.bind(Object(d.a)(t)),t.handleCheckGenre=t.handleCheck.bind(Object(d.a)(t)),t}return Object(g.a)(n,e),Object(i.a)(n,[{key:"getCheckedGenreIds",value:function(e){var n=e.map((function(e){return e.genres})),t=[];return n.forEach((function(e){e.forEach((function(e){!0===e.isChecked&&t.push(e.booksGenreId)}))})),t}},{key:"getCheckedGenreIdsForQuery",value:function(e,n){var t=this.getCheckedGenreIds(e);if(!1===n||t===[])return"[]";var a=t.toString().replace(/,/g,'","');return'["'.concat(a,'"]')}},{key:"getPageNum",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null===e||""===e?n:parseInt(e,10)}},{key:"getTitle",value:function(e){return""===e?'""':e}},{key:"handleSearchBooks",value:function(){var e,n=this.getCheckedGenreIdsForQuery(this.state.genreGroups,this.state.usedGenres),t=function(e){m.post("http://localhost:3001/graphql",{query:e}).then((function(e){return e.data.data.books})).catch((function(e){console.log(e)}))}((e={fields:["title"],variables:{title:this.getTitle(this.state.title),booksGenreId:n,pageNumFrom:this.getPageNum(this.state.pageFrom,0),pageNumTo:this.getPageNum(this.state.pageTo,9999)}},"\n    query { \n      books(".concat(f(e.variables),") {\n        ").concat(e.fields.toString(),"\n      }\n    }")));this.updateBooks(t)}},{key:"handleChange",value:function(e){var n=e.target.name;this.setState(Object(l.a)({},n,e.target.value))}},{key:"handleChangeToggle",value:function(e){var n=this.state.usedGenres;this.setState({usedGenres:!n})}},{key:"handleCheck",value:function(e,n){var t=this.state.genreGroups;t.forEach((function(t){t.booksGenreId.startsWith(e)&&(t.isChecked=!n),t.genres.forEach((function(t){t.booksGenreId.startsWith(e)&&(t.isChecked=!n)}))})),this.setState({genreGroups:t})}},{key:"updateBooks",value:function(e){this.setState({books:e})}},{key:"render",value:function(){var e=this;return this.state.hasError?r.a.createElement("h1",null,"Something went wrong."):r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"App-header"},r.a.createElement("h2",null,"\u6d0b\u66f8\u304a\u3059\u3059\u3081\u691c\u7d22")),r.a.createElement("form",{onSubmit:this.handleSearchBooks,className:"books-search-form"},r.a.createElement(J.a,{id:"title",name:"title",label:"\u30bf\u30a4\u30c8\u30eb",onChange:this.handleChangeTitleField,inputProps:{maxLength:20}}),r.a.createElement(J.a,{id:"page-from",name:"pageFrom",label:"\u6700\u5c0f\u30da\u30fc\u30b8\u6570",type:"number",onChange:this.handleChangePageFromField}),r.a.createElement(J.a,{id:"page-to",name:"pageTo",label:"\u6700\u5927\u30da\u30fc\u30b8\u6570",type:"number",onChange:this.handleChangePageToField}),r.a.createElement(Q.a,{control:r.a.createElement(R.a,{checked:this.state.usedGenres,onChange:this.handleChangeToggleGenre,color:"secondary"}),label:"\u30b8\u30e3\u30f3\u30eb\u3092\u4f7f\u7528\u3059\u308b"}),r.a.createElement(W.a,{in:this.state.usedGenres},r.a.createElement(x,{genreGroups:this.state.genreGroups,onClick:this.handleCheckGenre})),r.a.createElement(A.a,{variant:"contained",color:"primary",size:"large",onClick:function(){return e.handleSearchBooks()}},"\u691c\u7d22")),r.a.createElement(b,{books:this.state.books}))}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),n}(a.Component);t(121);c.a.render(r.a.createElement(H,null),document.getElementById("root"))},83:function(e,n,t){e.exports=t(122)},88:function(e,n,t){}},[[83,1,2]]]);
//# sourceMappingURL=main.c368a921.chunk.js.map